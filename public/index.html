<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Towing Workflow System</title>
    <link rel="stylesheet" href="styles.css">
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó Car Towing Workflow System</h1>
            <p>Manage work orders, arrivals, and customer notifications efficiently</p>
        </header>

        <div id="notification-area"></div>

        <div class="main-content">
            <!-- Work Order Creation Section -->
            <div class="card">
                <h2>üìã Create Work Order</h2>
                <form id="work-order-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customer-name">Customer Name *</label>
                            <input type="text" id="customer-name" name="customerName" required placeholder="Enter customer name">
                        </div>
                        <div class="form-group">
                            <label for="customer-phone">Customer Phone *</label>
                            <input type="tel" id="customer-phone" name="customerPhone" required placeholder="(555) 123-4567">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="car-make">Car Make *</label>
                            <input type="text" id="car-make" name="carMake" required placeholder="e.g., Toyota">
                        </div>
                        <div class="form-group">
                            <label for="car-model">Car Model *</label>
                            <input type="text" id="car-model" name="carModel" required placeholder="e.g., Camry">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="car-year">Car Year *</label>
                            <input type="number" id="car-year" name="carYear" required min="1990" max="2025" placeholder="2020">
                        </div>
                        <div class="form-group">
                            <label for="car-color">Car Color *</label>
                            <input type="text" id="car-color" name="carColor" required placeholder="e.g., Blue">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="tag-number">Tag Number *</label>
                            <input type="text" id="tag-number" name="tagNumber" required placeholder="e.g., ABC-1234">
                        </div>
                        <div class="form-group">
                            <label for="vin">VIN Number</label>
                            <input type="text" id="vin" name="vin" placeholder="Vehicle Identification Number">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="tow-location">Tow Location *</label>
                            <input type="text" id="tow-location" name="towLocation" required placeholder="Where is the car being towed from?">
                        </div>
                        <div class="form-group">
                            <label for="tow-reason">Reason for Tow *</label>
                            <select id="tow-reason" name="towReason" required>
                                <option value="">Select reason</option>
                                <option value="breakdown">Breakdown</option>
                                <option value="accident">Accident</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="inspection">Inspection</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="dangerous-location" name="dangerousLocation" style="width: 20px; height: 20px;">
                            <span style="font-weight: 600; color: var(--danger-color);">‚ö†Ô∏è Customer/Vehicle is in a dangerous location</span>
                        </label>
                        <small style="color: var(--text-secondary); display: block; margin-top: 5px; margin-left: 30px;">
                            Check if the vehicle or customer is in a dangerous spot (e.g., highway shoulder, busy intersection, unsafe area)
                        </small>
                    </div>

                    <div class="form-row">
                            <div class="form-group">
                                <label for="job-difficulty">Job Difficulty *</label>
                                <select id="job-difficulty" name="jobDifficulty" required>
                                    <option value="">Select difficulty</option>
                                    <option value="A">A - Complex/Senior Level</option>
                                    <option value="B">B - Moderate/Intermediate</option>
                                    <option value="C">C - Simple/Junior Level</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="job-urgency">Job Urgency</label>
                                <select id="job-urgency" name="jobUrgency">
                                    <option value="low">Low Priority</option>
                                    <option value="medium" selected>Medium Priority</option>
                                    <option value="high">High Priority</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="additional-notes">Additional Notes</label>
                        <textarea id="additional-notes" name="additionalNotes" rows="3" placeholder="Any additional information about the vehicle or situation"></textarea>
                    </div>

                    <button type="submit" class="btn-primary">Create Work Order</button>
                </form>
            </div>

            <!-- Active Work Orders Section -->
            <div class="card">
                <h2>üìã Active Work Orders</h2>
                <div id="work-orders-container">
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <div class="empty-state-text">No active work orders yet</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Technician Arrival Section -->
        <div class="card" style="margin-bottom: 30px;">
            <h2>üîî Technician Arrival Alert</h2>
            <p style="margin-bottom: 20px; color: var(--text-secondary);">Select the car that just arrived and click to notify Alex</p>
            
            <div class="form-group">
                <label for="arrival-car-select">Select Arrived Car</label>
                <select id="arrival-car-select" class="select-car">
                    <option value="">-- Select a car being towed --</option>
                </select>
            </div>
            
            <button id="arrival-alert-btn" class="arrival-button" disabled>
                üö® CAR ARRIVED - Notify Alex
            </button>
        </div>

        <!-- Alex's Assignment Panel -->
        <div class="assignment-panel">
            <h2>ü§ñ Alex's Job Assignment Panel</h2>
            <p>Intelligent job assignment based on tech ratings, qualifications, availability, and bay optimization</p>
            
            <div class="assignment-info">
                <div class="assignment-box">
                    <div class="assignment-number" id="stat-pending-jobs">0</div>
                    <div class="assignment-label">Pending Jobs</div>
                </div>
                <div class="assignment-box">
                    <div class="assignment-number" id="stat-available-techs">0</div>
                    <div class="assignment-label">Available Techs</div>
                </div>
                <div class="assignment-box">
                    <div class="assignment-number" id="stat-empty-bays">0</div>
                    <div class="assignment-label">Empty Bays</div>
                </div>
                <div class="assignment-box">
                    <div class="assignment-number" id="stat-next-urgency">-</div>
                    <div class="assignment-label">Next Job Urgency</div>
                </div>
            </div>

            <div id="assignment-recommendation-area"></div>
        </div>

        <!-- Queue Management Section -->
        <div class="queue-section">
            <h2 style="margin-bottom: 20px; color: var(--text-primary);">üìä Queue Management</h2>
            
            <div class="queue-stats">
                <div class="stat-box">
                    <div class="stat-number" id="stat-towing">0</div>
                    <div class="stat-label">Being Towed</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="stat-arrived">0</div>
                    <div class="stat-label">Arrived</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="stat-queue">0</div>
                    <div class="stat-label">In Queue</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="stat-total">0</div>
                    <div class="stat-label">Total Cars</div>
                </div>
            </div>

            <div class="queue-grid">
                <!-- Being Towed Column -->
                <div class="queue-column">
                    <h3>üöõ Being Towed</h3>
                    <div id="towing-queue">
                        <div class="empty-state">
                            <div class="empty-state-text">No cars being towed</div>
                        </div>
                    </div>
                </div>

                <!-- Arrived Column -->
                <div class="queue-column">
                    <h3>üèÅ Arrived</h3>
                    <div id="arrived-queue">
                        <div class="empty-state">
                            <div class="empty-state-text">No cars arrived yet</div>
                        </div>
                    </div>
                </div>

                <!-- Customer Notified Column -->
                <div class="queue-column">
                    <h3>üìû Customer Notified</h3>
                    <div id="notified-queue">
                        <div class="empty-state">
                            <div class="empty-state-text">No customers notified yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tech Management Section -->
        <div class="queue-section">
            <h2 style="margin-bottom: 20px; color: var(--text-primary);">üë∑ Technician Management</h2>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button onclick="openTechModal()" class="btn-primary">+ Add Technician</button>
                <button onclick="openSettingsModal()" class="btn-warning">‚öôÔ∏è Shop Settings</button>
            </div>
            <div class="tech-grid" id="tech-grid">
                <div class="empty-state" style="grid-column: 1/-1;">
                    <div class="empty-state-text">No technicians added yet</div>
                </div>
            </div>
        </div>

        <!-- Bay Management Section -->
        <div class="queue-section">
            <h2 style="margin-bottom: 20px; color: var(--text-primary);">üèóÔ∏è Shop Bays</h2>
            <div class="bay-grid" id="bay-grid">
                <div class="empty-state" style="grid-column: 1/-1;">
                    <div class="empty-state-text">No bays configured</div>
                </div>
            </div>
        </div>

        <!-- Tow Company Management Section -->
        <div class="queue-section">
            <h2 style="margin-bottom: 20px; color: var(--text-primary);">üöõ Tow Company Management</h2>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button onclick="openTowCompanyModal()" class="btn-primary">+ Add Tow Company</button>
            </div>
            <div class="tech-grid" id="tow-company-grid">
                <div class="empty-state" style="grid-column: 1/-1;">
                    <div class="empty-state-text">No tow companies added yet</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tow Company Modal -->
    <div id="tow-company-modal" class="modal-overlay">
        <div class="modal-content dangerous-location-modal">
            <div class="modal-header">
                <h3>Add Tow Company</h3>
                <button class="modal-close" onclick="closeTowCompanyModal()">&times;</button>
            </div>
            <form id="tow-company-form">
                <div class="form-group">
                    <label for="tow-company-name">Company Name *</label>
                    <input type="text" id="tow-company-name" name="towCompanyName" required placeholder="e.g., ABC Towing">
                </div>
                <div class="form-group">
                    <label for="tow-company-phone">Phone Number *</label>
                    <input type="tel" id="tow-company-phone" name="towCompanyPhone" required placeholder="(555) 123-4567">
                </div>
                <div class="form-group">
                    <label for="tow-company-notes">Notes</label>
                    <textarea id="tow-company-notes" name="towCompanyNotes" rows="2" placeholder="Any notes about this tow company"></textarea>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Add Tow Company</button>
            </form>
        </div>
    </div>

    <!-- Call Tow Company Modal -->
    <div id="call-tow-modal" class="modal-overlay">
        <div class="modal-content dangerous-location-modal">
            <div class="modal-header">
                <h3>üìû Call Tow Company</h3>
                <button class="modal-close" onclick="closeCallTowModal()">&times;</button>
            </div>
            <div id="call-tow-content"></div>
        </div>
    </div>

    <!-- Dangerous Location Modal -->
    <div id="dangerous-modal" class="modal-overlay">
        <div class="modal-content dangerous-location-modal">
            <div class="modal-header">
                <h3>‚ö†Ô∏è DANGEROUS LOCATION ALERT</h3>
                <button class="modal-close" onclick="closeDangerousModal()">&times;</button>
            </div>
            <div class="dangerous-warning">
                <h4>‚ö° IMMEDIATE SAFETY WARNING</h4>
                <p>The customer or vehicle is reported to be in a dangerous location.</p>
                <ul>
                    <li><strong>CUSTOMER SHOULD CALL 911 IMMEDIATELY</strong> for police/emergency assistance</li>
                    <li>Tow truck is on the way with ETA: <span id="dangerous-eta" class="emergency">--</span></li>
                    <li>Police have been notified of the dangerous situation</li>
                    <li>Tow company has been alerted to the dangerous location</li>
                </ul>
            </div>
            <div id="dangerous-work-order-details"></div>
            <div class="call-actions" style="margin-top: 20px;">
                <button onclick="confirmDangerousHandled()" class="btn-success" style="flex: 1;">
                    ‚úì Customer Informed & 911 Called
                </button>
                <button onclick="closeDangerousModal()" class="btn-warning">
                    Dismiss
                </button>
            </div>
        </div>
    </div>

    <!-- Technician Modal -->
    <div id="tech-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Technician</h3>
                <button class="modal-close" onclick="closeTechModal()">&times;</button>
            </div>
            <form id="tech-form">
                <div class="form-group">
                    <label for="tech-name">Technician Name *</label>
                    <input type="text" id="tech-name" name="techName" required placeholder="Enter tech name">
                </div>
                <div class="form-group">
                    <label for="tech-rating">Tech Rating *</label>
                    <select id="tech-rating" name="techRating" required>
                        <option value="">Select rating</option>
                        <option value="A">A - Senior/Expert</option>
                        <option value="B">B - Intermediate</option>
                        <option value="C">C - Junior/Apprentice</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tech-qualifications">Qualifications</label>
                    <input type="text" id="tech-qualifications" name="techQualifications" placeholder="e.g., Engine, Brakes, Electrical (comma-separated)">
                </div>
                <div class="form-group">
                    <label for="tech-phone">Phone Number</label>
                    <input type="tel" id="tech-phone" name="techPhone" placeholder="(555) 123-4567">
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Add Technician</button>
            </form>
        </div>
    </div>

    <!-- Shop Settings Modal -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Shop Settings</h3>
                <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
            </div>
            <form id="settings-form">
                <div class="form-group">
                    <label for="num-bays">Number of Bays *</label>
                    <input type="number" id="num-bays" name="numBays" required min="1" max="20" value="4">
                </div>
                <div class="form-group">
                    <label for="shop-name">Shop Name</label>
                    <input type="text" id="shop-name" name="shopName" placeholder="Your Shop Name">
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Save Settings</button>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
