<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VHICL Pro - Auto Shop Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }

        .navbar {
            background: #0a2540;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .nav-brand {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-brand i {
            color: #00d4ff;
        }

        .nav-links {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.7);
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-size: 0.9rem;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .nav-btn:hover, .nav-btn.active {
            background: rgba(0,212,255,0.2);
            color: #00d4ff;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .screen {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #0a2540;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .stat-card.revenue {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .stat-card.blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .stat-card.green {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .stat-label {
            opacity: 0.9;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #00d4ff;
            color: #0a2540;
            font-weight: bold;
        }

        .btn-primary:hover {
            background: #00a8cc;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #43e97b;
            color: white;
        }

        .btn-danger {
            background: #f5576c;
            color: white;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #0a2540;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-completed {
            background: #cce5ff;
            color: #004085;
        }

        .status-unpaid {
            background: #f8d7da;
            color: #721c24;
        }

        .status-paid {
            background: #d4edda;
            color: #155724;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #0a2540;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #00d4ff;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            color: #0a2540;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .inventory-item {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .inventory-item-name {
            font-weight: bold;
            color: #0a2540;
            margin-bottom: 0.5rem;
        }

        .inventory-item-details {
            font-size: 0.9rem;
            color: #666;
        }

        .inventory-item-value {
            font-weight: bold;
            color: #43e97b;
            margin-top: 0.5rem;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <i class="fas fa-car"></i>
            VHICL Pro
        </div>
        <div class="nav-links">
            <button class="nav-btn active" onclick="showScreen('dashboard')">üè† Dashboard</button>
            <button class="nav-btn" onclick="showScreen('customers')">üë• Customers</button>
            <button class="nav-btn" onclick="showScreen('appointments')">üìÖ Appointments</button>
            <button class="nav-btn" onclick="showScreen('estimates')">üìã Estimates</button>
            <button class="nav-btn" onclick="showScreen('invoices')">üí∞ Invoices</button>
            <button class="nav-btn" onclick="showScreen('towing')">üöó Towing</button>
            <button class="nav-btn" onclick="showScreen('inventory')">üì¶ Inventory</button>
            <button class="nav-btn" onclick="showScreen('analytics')">üìä Analytics</button>
            <button class="nav-btn" onclick="showScreen('settings')">‚öôÔ∏è Settings</button>
        </div>
    </nav>

    <div class="container">
        <!-- Error Message -->
        <div id="errorMessage" class="error-message"></div>

        <!-- Dashboard Screen -->
        <div id="dashboard" class="screen active">
            <h1 style="color: white; margin-bottom: 1.5rem;">üè† Dashboard</h1>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Today's Revenue</div>
                    <div class="stat-value">$1,234</div>
                    <div class="stat-label"><i class="fas fa-arrow-up"></i> +12% from yesterday</div>
                </div>
                <div class="stat-card revenue">
                    <div class="stat-label">Total Jobs</div>
                    <div class="stat-value">8</div>
                    <div class="stat-label"><i class="fas fa-check"></i> 6 completed</div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-label">Appointments</div>
                    <div class="stat-value">5</div>
                    <div class="stat-label"><i class="fas fa-clock"></i> 2 today</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-label">Pending Estimates</div>
                    <div class="stat-value">3</div>
                    <div class="stat-label"><i class="fas fa-file-alt"></i> awaiting approval</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Quick Actions</h2>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <button class="btn btn-primary" onclick="showScreen('appointments')">
                        <i class="fas fa-calendar-plus"></i> New Appointment
                    </button>
                    <button class="btn btn-primary" onclick="showScreen('customers')">
                        <i class="fas fa-user-plus"></i> Add Customer
                    </button>
                    <button class="btn btn-primary" onclick="showScreen('estimates')">
                        <i class="fas fa-file-invoice"></i> Create Estimate
                    </button>
                    <button class="btn btn-primary" onclick="showScreen('towing')">
                        <i class="fas fa-truck"></i> Request Tow
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Recent Activity</h2>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Activity</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>10:30 AM</td>
                            <td>Oil Change - John Smith</td>
                            <td><span class="status-badge status-completed">Completed</span></td>
                        </tr>
                        <tr>
                            <td>9:15 AM</td>
                            <td>Brake Repair - Jane Doe</td>
                            <td><span class="status-badge status-pending">In Progress</span></td>
                        </tr>
                        <tr>
                            <td>8:00 AM</td>
                            <td>New Appointment - Bob Wilson</td>
                            <td><span class="status-badge status-approved">Scheduled</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Customers Screen -->
        <div id="customers" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üë• Customers & Vehicles</h1>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Customer List</h2>
                    <button class="btn btn-primary" onclick="openCustomerModal()">
                        <i class="fas fa-plus"></i> Add Customer
                    </button>
                </div>
                <div id="customerList" class="loading">Loading customers...</div>
            </div>
        </div>

        <!-- Appointments Screen -->
        <div id="appointments" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üìÖ Appointments</h1>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Appointment Calendar</h2>
                    <button class="btn btn-primary" onclick="openAppointmentModal()">
                        <i class="fas fa-plus"></i> New Appointment
                    </button>
                </div>
                <div id="appointmentList" class="loading">Loading appointments...</div>
            </div>
        </div>

        <!-- Estimates Screen -->
        <div id="estimates" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üìã Estimates</h1>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Estimate List</h2>
                    <button class="btn btn-primary" onclick="openEstimateModal()">
                        <i class="fas fa-plus"></i> New Estimate
                    </button>
                </div>
                <div id="estimateList" class="loading">Loading estimates...</div>
            </div>
        </div>

        <!-- Invoices Screen -->
        <div id="invoices" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üí∞ Invoices</h1>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Invoice List</h2>
                    <button class="btn btn-primary" onclick="openInvoiceModal()">
                        <i class="fas fa-plus"></i> New Invoice
                    </button>
                </div>
                <div id="invoiceList" class="loading">Loading invoices...</div>
            </div>
        </div>

        <!-- Towing Screen -->
        <div id="towing" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üöó Towing</h1>
            <div class="stats-grid">
                <div class="stat-card blue">
                    <div class="stat-label">Pending Requests</div>
                    <div class="stat-value" id="pendingTowing">2</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-label">Assigned</div>
                    <div class="stat-value" id="assignedTowing">1</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Arrived</div>
                    <div class="stat-value" id="arrivedTowing">0</div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Towing Requests</h2>
                    <button class="btn btn-primary" onclick="openTowingModal()">
                        <i class="fas fa-plus"></i> New Request
                    </button>
                </div>
                <div id="towingList" class="loading">Loading towing requests...</div>
            </div>
        </div>

        <!-- Inventory Screen -->
        <div id="inventory" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üì¶ Inventory Management</h1>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Items</div>
                    <div class="stat-value" id="totalInventoryItems">0</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-label">Current Value</div>
                    <div class="stat-value" id="inventoryValue">$0</div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-label">Low Stock Items</div>
                    <div class="stat-value" id="lowStockItems">0</div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Parts Inventory</h2>
                    <button class="btn btn-primary" onclick="openInventoryModal()">
                        <i class="fas fa-plus"></i> Add Item
                    </button>
                </div>
                <div id="inventoryList" class="loading">Loading inventory...</div>
            </div>
        </div>

        <!-- Analytics Screen -->
        <div id="analytics" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">üìä Analytics Dashboard</h1>
            <div class="stats-grid">
                <div class="stat-card revenue">
                    <div class="stat-label">Revenue This Month</div>
                    <div class="stat-value">$15,234</div>
                    <div class="stat-label"><i class="fas fa-arrow-up"></i> +8% from last month</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Jobs</div>
                    <div class="stat-value">45</div>
                    <div class="stat-label"><i class="fas fa-wrench"></i> This month</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-label">Average Job Value</div>
                    <div class="stat-value">$338</div>
                    <div class="stat-label"><i class="fas fa-chart-line"></i> +12% from last month</div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-label">Total Customers</div>
                    <div class="stat-value">128</div>
                    <div class="stat-label"><i class="fas fa-users"></i> Active accounts</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Revenue by Service Type</h2>
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                    <div style="flex: 1; min-width: 200px; padding: 1rem; background: #f8f9fa; border-radius: 5px;">
                        <div style="font-weight: bold; color: #0a2540;">Brake Service</div>
                        <div style="font-size: 1.5rem; color: #00d4ff;">$4,200</div>
                        <div style="font-size: 0.8rem; color: #666;">28% of revenue</div>
                    </div>
                    <div style="flex: 1; min-width: 200px; padding: 1rem; background: #f8f9fa; border-radius: 5px;">
                        <div style="font-weight: bold; color: #0a2540;">Oil Changes</div>
                        <div style="font-size: 1.5rem; color: #00d4ff;">$2,100</div>
                        <div style="font-size: 0.8rem; color: #666;">14% of revenue</div>
                    </div>
                    <div style="flex: 1; min-width: 200px; padding: 1rem; background: #f8f9fa; border-radius: 5px;">
                        <div style="font-weight: bold; color: #0a2540;">Suspension Work</div>
                        <div style="font-size: 1.5rem; color: #00d4ff;">$3,400</div>
                        <div style="font-size: 0.8rem; color: #666;">22% of revenue</div>
                    </div>
                    <div style="flex: 1; min-width: 200px; padding: 1rem; background: #f8f9fa; border-radius: 5px;">
                        <div style="font-weight: bold; color: #0a2540;">Engine Repairs</div>
                        <div style="font-size: 1.5rem; color: #00d4ff;">$5,534</div>
                        <div style="font-size: 0.8rem; color: #666;">36% of revenue</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Top Technicians</h2>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Technician</th>
                            <th>Jobs Completed</th>
                            <th>Revenue Generated</th>
                            <th>Average Job Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mike Johnson</td>
                            <td>15</td>
                            <td>$5,200</td>
                            <td>2.3 hours</td>
                        </tr>
                        <tr>
                            <td>Sarah Williams</td>
                            <td>12</td>
                            <td>$4,100</td>
                            <td>2.1 hours</td>
                        </tr>
                        <tr>
                            <td>Tom Davis</td>
                            <td>18</td>
                            <td>$5,934</td>
                            <td>2.5 hours</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Settings Screen -->
        <div id="settings" class="screen">
            <h1 style="color: white; margin-bottom: 1.5rem;">‚öôÔ∏è Shop Settings</h1>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Pricing & Markup Settings</h2>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                    <div class="form-group">
                        <label>Labor Rate ($/hour)</label>
                        <input type="number" id="laborRate" value="100" min="0" step="1">
                    </div>
                    <div class="form-group">
                        <label>Diagnostic Fee ($)</label>
                        <input type="number" id="diagnosticFee" value="85" min="0" step="1">
                    </div>
                    <div class="form-group">
                        <label>Environmental Fee ($)</label>
                        <input type="number" id="envFee" value="15" min="0" step="1">
                    </div>
                    <div class="form-group">
                        <label>Parts Markup (%)</label>
                        <input type="number" id="partsMarkup" value="30" min="0" max="100" step="1">
                    </div>
                    <div class="form-group">
                        <label>Sales Tax (%)</label>
                        <input type="number" id="salesTax" value="7" min="0" max="15" step="0.1">
                    </div>
                </div>
                <div class="form-group" style="margin-top: 1rem;">
                    <label>
                        <input type="checkbox" id="usePartsMatrix">
                        Use Parts Markup Matrix
                    </label>
                </div>
                <button class="btn btn-primary" onclick="saveSettings()">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>

            <div class="card" id="partsMatrixCard" style="display: none;">
                <div class="card-header">
                    <h2 class="card-title">Parts Markup Matrix</h2>
                </div>
                <p style="color: #666; margin-bottom: 1rem;">Configure different markup percentages based on part price ranges:</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div class="form-group">
                        <label>Under $50</label>
                        <input type="number" id="markup50" value="50" min="0" max="100" step="1">
                    </div>
                    <div class="form-group">
                        <label>$50 - $100</label>
                        <input type="number" id="markup100" value="40" min="0" max="100" step="1">
                    </div>
                    <div class="form-group">
                        <label>$100 - $500</label>
                        <input type="number" id="markup500" value="30" min="0" max="100" step="1">
                    </div>
                    <div class="form-group">
                        <label>$500 - $1000</label>
                        <input type="number" id="markup1000" value="25" min="0" max="100" step="1">
                    </div>
                    <div class="form-group">
                        <label>Over $1000</label>
                        <input type="number" id="markupOver1000" value="20" min="0" max="100" step="1">
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Shop Information</h2>
                </div>
                <div class="form-group">
                    <label>Shop Name</label>
                    <input type="text" id="shopName" value="VHICL Pro Auto Shop">
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="shopPhone" value="(555) 123-4567">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="shopEmail" value="info@vhiclpro.com">
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <input type="text" id="shopAddress" value="123 Main St, Anytown, USA">
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="customerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Customer</h2>
                <button class="close-btn" onclick="closeModal('customerModal')">&times;</button>
            </div>
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="customerName">
            </div>
            <div class="form-group">
                <label>Phone</label>
                <input type="tel" id="customerPhone">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="customerEmail">
            </div>
            <div class="form-group">
                <label>Vehicle Year</label>
                <input type="number" id="vehicleYear" min="1990" max="2030">
            </div>
            <div class="form-group">
                <label>Vehicle Make</label>
                <input type="text" id="vehicleMake">
            </div>
            <div class="form-group">
                <label>Vehicle Model</label>
                <input type="text" id="vehicleModel">
            </div>
            <div class="form-group">
                <label>License Plate</label>
                <input type="text" id="licensePlate">
            </div>
            <button class="btn btn-primary" onclick="saveCustomer()">Save Customer</button>
        </div>
    </div>

    <div id="appointmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>New Appointment</h2>
                <button class="close-btn" onclick="closeModal('appointmentModal')">&times;</button>
            </div>
            <div class="form-group">
                <label>Customer</label>
                <select id="appointmentCustomer"></select>
            </div>
            <div class="form-group">
                <label>Date</label>
                <input type="date" id="appointmentDate">
            </div>
            <div class="form-group">
                <label>Time</label>
                <input type="time" id="appointmentTime">
            </div>
            <div class="form-group">
                <label>Service Type</label>
                <select id="serviceType">
                    <option value="Oil Change">Oil Change</option>
                    <option value="Brake Service">Brake Service</option>
                    <option value="Suspension">Suspension</option>
                    <option value="Engine Repair">Engine Repair</option>
                    <option value="Diagnostic">Diagnostic</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>Notes</label>
                <textarea id="appointmentNotes" rows="3"></textarea>
            </div>
            <button class="btn btn-primary" onclick="saveAppointment()">Schedule Appointment</button>
        </div>
    </div>

    <div id="towingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>New Towing Request</h2>
                <button class="close-btn" onclick="closeModal('towingModal')">&times;</button>
            </div>
            <div class="form-group">
                <label>Customer Name</label>
                <input type="text" id="towingCustomer">
            </div>
            <div class="form-group">
                <label>Customer Phone</label>
                <input type="tel" id="towingPhone">
            </div>
            <div class="form-group">
                <label>Pickup Location</label>
                <textarea id="towingLocation" rows="2"></textarea>
            </div>
            <div class="form-group">
                <label>Vehicle Details</label>
                <input type="text" id="towingVehicle" placeholder="2018 Honda Accord - Red">
            </div>
            <div class="form-group">
                <label>License Plate</label>
                <input type="text" id="towingPlate">
            </div>
            <div class="form-group">
                <label>Destination</label>
                <select id="towingDestination">
                    <option value="shop">Our Shop</option>
                    <option value="other">Other Location</option>
                </select>
            </div>
            <div class="form-group">
                <label>Key Location</label>
                <select id="keyLocation">
                    <option value="with-customer">With Customer</option>
                    <option value="in-vehicle">In Vehicle</option>
                    <option value="drop-box">Drop Box</option>
                </select>
            </div>
            <div class="form-group">
                <label>Customer Will Meet Driver</label>
                <select id="meetDriver">
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="saveTowingRequest()">Submit Request</button>
        </div>
    </div>

    <div id="inventoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Inventory Item</h2>
                <button class="close-btn" onclick="closeModal('inventoryModal')">&times;</button>
            </div>
            <div class="form-group">
                <label>Part Name</label>
                <input type="text" id="inventoryName">
            </div>
            <div class="form-group">
                <label>Part Number</label>
                <input type="text" id="inventoryPartNumber">
            </div>
            <div class="form-group">
                <label>Category</label>
                <select id="inventoryCategory">
                    <option value="Brakes">Brakes</option>
                    <option value="Engine">Engine</option>
                    <option value="Suspension">Suspension</option>
                    <option value="Electrical">Electrical</option>
                    <option value="Fluids">Fluids</option>
                    <option value="Filters">Filters</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>Quantity</label>
                <input type="number" id="inventoryQuantity" value="1" min="1">
            </div>
            <div class="form-group">
                <label>Cost ($)</label>
                <input type="number" id="inventoryCost" value="0" min="0" step="0.01">
            </div>
            <div class="form-group">
                <label>Sell Price ($)</label>
                <input type="number" id="inventoryPrice" value="0" min="0" step="0.01">
            </div>
            <div class="form-group">
                <label>Reorder Point</label>
                <input type="number" id="inventoryReorderPoint" value="2" min="1">
            </div>
            <button class="btn btn-primary" onclick="saveInventoryItem()">Add Item</button>
        </div>
    </div>

    <script>
        // ============ GLOBAL VARIABLES ============
        let customers = [];
        let appointments = [];
        let estimates = [];
        let invoices = [];
        let towingRequests = [];
        let inventory = [];
        let settings = {};

        // ============ SHOW SCREEN FUNCTION ============
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
            }
            
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Find and activate the clicked button
            event.target.classList.add('active');
        }

        // ============ INITIALIZE ============
        document.addEventListener('DOMContentLoaded', function() {
            // Load data from localStorage
            loadFromStorage();
            
            // Load settings
            loadSettings();
            
            // Initialize sample data if empty
            if (customers.length === 0) initSampleCustomers();
            if (inventory.length === 0) initSampleInventory();
            if (towingRequests.length === 0) initSampleTowing();
            if (estimates.length === 0) initSampleEstimates();
            if (invoices.length === 0) initSampleInvoices();
            
            // Render all screens
            renderCustomers();
            renderAppointments();
            renderEstimates();
            renderInvoices();
            renderTowing();
            renderInventory();
        });

        // ============ STORAGE FUNCTIONS ============
        function loadFromStorage() {
            try {
                customers = JSON.parse(localStorage.getItem('vhicl_customers') || '[]');
                appointments = JSON.parse(localStorage.getItem('vhicl_appointments') || '[]');
                estimates = JSON.parse(localStorage.getItem('vhicl_estimates') || '[]');
                invoices = JSON.parse(localStorage.getItem('vhicl_invoices') || '[]');
                towingRequests = JSON.parse(localStorage.getItem('vhicl_towing') || '[]');
                inventory = JSON.parse(localStorage.getItem('vhicl_inventory') || '[]');
                settings = JSON.parse(localStorage.getItem('vhicl_settings') || '{}');
            } catch (error) {
                console.error('Error loading from storage:', error);
            }
        }

        function saveToStorage() {
            localStorage.setItem('vhicl_customers', JSON.stringify(customers));
            localStorage.setItem('vhicl_appointments', JSON.stringify(appointments));
            localStorage.setItem('vhicl_estimates', JSON.stringify(estimates));
            localStorage.setItem('vhicl_invoices', JSON.stringify(invoices));
            localStorage.setItem('vhicl_towing', JSON.stringify(towingRequests));
            localStorage.setItem('vhicl_inventory', JSON.stringify(inventory));
        }

        // ============ SETTINGS FUNCTIONS ============
        function loadSettings() {
            // Load from localStorage or use defaults
            const savedSettings = JSON.parse(localStorage.getItem('vhicl_settings') || '{}');
            
            settings = {
                laborRate: savedSettings.laborRate || 100,
                diagnosticFee: savedSettings.diagnosticFee || 85,
                envFee: savedSettings.envFee || 15,
                partsMarkup: savedSettings.partsMarkup || 30,
                salesTax: savedSettings.salesTax || 7,
                usePartsMatrix: savedSettings.usePartsMatrix || false,
                markup50: savedSettings.markup50 || 50,
                markup100: savedSettings.markup100 || 40,
                markup500: savedSettings.markup500 || 30,
                markup1000: savedSettings.markup1000 || 25,
                markupOver1000: savedSettings.markupOver1000 || 20,
                shopName: savedSettings.shopName || 'VHICL Pro Auto Shop',
                shopPhone: savedSettings.shopPhone || '(555) 123-4567',
                shopEmail: savedSettings.shopEmail || 'info@vhiclpro.com',
                shopAddress: savedSettings.shopAddress || '123 Main St, Anytown, USA'
            };
            
            // Populate form fields
            document.getElementById('laborRate').value = settings.laborRate;
            document.getElementById('diagnosticFee').value = settings.diagnosticFee;
            document.getElementById('envFee').value = settings.envFee;
            document.getElementById('partsMarkup').value = settings.partsMarkup;
            document.getElementById('salesTax').value = settings.salesTax;
            document.getElementById('usePartsMatrix').checked = settings.usePartsMatrix;
            document.getElementById('markup50').value = settings.markup50;
            document.getElementById('markup100').value = settings.markup100;
            document.getElementById('markup500').value = settings.markup500;
            document.getElementById('markup1000').value = settings.markup1000;
            document.getElementById('markupOver1000').value = settings.markupOver1000;
            document.getElementById('shopName').value = settings.shopName;
            document.getElementById('shopPhone').value = settings.shopPhone;
            document.getElementById('shopEmail').value = settings.shopEmail;
            document.getElementById('shopAddress').value = settings.shopAddress;
            
            // Show/hide parts matrix
            togglePartsMatrix();
        }

        function saveSettings() {
            settings = {
                laborRate: parseFloat(document.getElementById('laborRate').value) || 100,
                diagnosticFee: parseFloat(document.getElementById('diagnosticFee').value) || 85,
                envFee: parseFloat(document.getElementById('envFee').value) || 15,
                partsMarkup: parseFloat(document.getElementById('partsMarkup').value) || 30,
                salesTax: parseFloat(document.getElementById('salesTax').value) || 7,
                usePartsMatrix: document.getElementById('usePartsMatrix').checked,
                markup50: parseFloat(document.getElementById('markup50').value) || 50,
                markup100: parseFloat(document.getElementById('markup100').value) || 40,
                markup500: parseFloat(document.getElementById('markup500').value) || 30,
                markup1000: parseFloat(document.getElementById('markup1000').value) || 25,
                markupOver1000: parseFloat(document.getElementById('markupOver1000').value) || 20,
                shopName: document.getElementById('shopName').value,
                shopPhone: document.getElementById('shopPhone').value,
                shopEmail: document.getElementById('shopEmail').value,
                shopAddress: document.getElementById('shopAddress').value
            };
            
            localStorage.setItem('vhicl_settings', JSON.stringify(settings));
            alert('Settings saved successfully!');
        }

        function togglePartsMatrix() {
            const checkbox = document.getElementById('usePartsMatrix');
            const matrixCard = document.getElementById('partsMatrixCard');
            matrixCard.style.display = checkbox.checked ? 'block' : 'none';
        }

        document.getElementById('usePartsMatrix')?.addEventListener('change', togglePartsMatrix);

        // ============ MODAL FUNCTIONS ============
        function openCustomerModal() {
            document.getElementById('customerModal').classList.add('active');
            populateCustomerDropdown();
        }

        function openAppointmentModal() {
            document.getElementById('appointmentModal').classList.add('active');
            populateCustomerDropdown();
        }

        function openTowingModal() {
            document.getElementById('towingModal').classList.add('active');
        }

        function openInventoryModal() {
            document.getElementById('inventoryModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Close modal when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // ============ CUSTOMER FUNCTIONS ============
        function populateCustomerDropdown() {
            const select = document.getElementById('appointmentCustomer');
            select.innerHTML = '<option value="">Select Customer</option>';
            customers.forEach(customer => {
                select.innerHTML += `<option value="${customer.id}">${customer.name}</option>`;
            });
        }

        function saveCustomer() {
            const customer = {
                id: Date.now(),
                name: document.getElementById('customerName').value,
                phone: document.getElementById('customerPhone').value,
                email: document.getElementById('customerEmail').value,
                vehicles: [{
                    year: document.getElementById('vehicleYear').value,
                    make: document.getElementById('vehicleMake').value,
                    model: document.getElementById('vehicleModel').value,
                    plate: document.getElementById('licensePlate').value
                }]
            };
            
            customers.push(customer);
            saveToStorage();
            renderCustomers();
            closeModal('customerModal');
            
            // Clear form
            document.getElementById('customerName').value = '';
            document.getElementById('customerPhone').value = '';
            document.getElementById('customerEmail').value = '';
        }

        function renderCustomers() {
            const list = document.getElementById('customerList');
            if (customers.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">No customers yet. Add your first customer!</p>';
                return;
            }
            
            list.innerHTML = customers.map(customer => `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="color: #0a2540; margin-bottom: 0.5rem;">${customer.name}</h3>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-phone"></i> ${customer.phone}</p>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-envelope"></i> ${customer.email}</p>
                            ${customer.vehicles.map(v => `
                                <p style="color: #00d4ff; margin: 0.25rem 0; font-size: 0.9rem;">
                                    <i class="fas fa-car"></i> ${v.year} ${v.make} ${v.model} (${v.plate})
                                </p>
                            `).join('')}
                        </div>
                        <button class="btn btn-danger" onclick="deleteCustomer(${customer.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function deleteCustomer(id) {
            if (confirm('Are you sure you want to delete this customer?')) {
                customers = customers.filter(c => c.id !== id);
                saveToStorage();
                renderCustomers();
            }
        }

        function initSampleCustomers() {
            customers = [
                {
                    id: 1,
                    name: 'John Smith',
                    phone: '(555) 111-2222',
                    email: 'john@example.com',
                    vehicles: [
                        { year: 2018, make: 'Honda', model: 'Accord', plate: 'ABC123' }
                    ]
                },
                {
                    id: 2,
                    name: 'Jane Doe',
                    phone: '(555) 333-4444',
                    email: 'jane@example.com',
                    vehicles: [
                        { year: 2020, make: 'Toyota', model: 'Camry', plate: 'XYZ789' }
                    ]
                }
            ];
            saveToStorage();
        }

        // ============ APPOINTMENT FUNCTIONS ============
        function saveAppointment() {
            const appointment = {
                id: Date.now(),
                customerId: document.getElementById('appointmentCustomer').value,
                customerName: customers.find(c => c.id == document.getElementById('appointmentCustomer').value)?.name || 'Unknown',
                date: document.getElementById('appointmentDate').value,
                time: document.getElementById('appointmentTime').value,
                serviceType: document.getElementById('serviceType').value,
                notes: document.getElementById('appointmentNotes').value,
                status: 'Scheduled'
            };
            
            appointments.push(appointment);
            saveToStorage();
            renderAppointments();
            closeModal('appointmentModal');
        }

        function renderAppointments() {
            const list = document.getElementById('appointmentList');
            if (appointments.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">No appointments scheduled yet.</p>';
                return;
            }
            
            list.innerHTML = appointments.map(apt => `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="color: #0a2540; margin-bottom: 0.5rem;">${apt.customerName}</h3>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-calendar"></i> ${apt.date} at ${apt.time}</p>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-wrench"></i> ${apt.serviceType}</p>
                            ${apt.notes ? `<p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-comment"></i> ${apt.notes}</p>` : ''}
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <span class="status-badge status-approved">${apt.status}</span>
                            <button class="btn btn-danger" onclick="deleteAppointment(${apt.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function deleteAppointment(id) {
            if (confirm('Are you sure you want to delete this appointment?')) {
                appointments = appointments.filter(a => a.id !== id);
                saveToStorage();
                renderAppointments();
            }
        }

        // ============ ESTIMATE FUNCTIONS ============
        function openEstimateModal() {
            alert('Estimate creation modal will open here. For now, view sample estimates below.');
        }

        function initSampleEstimates() {
            estimates = [
                {
                    id: 1,
                    customerName: 'John Smith',
                    vehicle: '2018 Honda Accord',
                    date: '2025-01-15',
                    status: 'Approved',
                    parts: [
                        { name: 'Brake Pads (Front)', price: 85, quantity: 1 },
                        { name: 'Rotors (Front)', price: 120, quantity: 2 }
                    ],
                    labor: { hours: 2, rate: 100 },
                    total: 405
                },
                {
                    id: 2,
                    customerName: 'Jane Doe',
                    vehicle: '2020 Toyota Camry',
                    date: '2025-01-16',
                    status: 'Pending',
                    parts: [
                        { name: 'Oil Filter', price: 15, quantity: 1 },
                        { name: 'Synthetic Oil (5qt)', price: 45, quantity: 1 }
                    ],
                    labor: { hours: 0.5, rate: 100 },
                    total: 60
                }
            ];
            saveToStorage();
        }

        function renderEstimates() {
            const list = document.getElementById('estimateList');
            if (estimates.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">No estimates yet.</p>';
                return;
            }
            
            list.innerHTML = estimates.map(est => `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="color: #0a2540; margin-bottom: 0.5rem;">${est.customerName} - ${est.vehicle}</h3>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-calendar"></i> ${est.date}</p>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-car"></i> ${est.vehicle}</p>
                            <p style="font-weight: bold; color: #0a2540; margin-top: 0.5rem;">Total: $${est.total.toFixed(2)}</p>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <span class="status-badge status-${est.status.toLowerCase()}">${est.status}</span>
                            <button class="btn btn-primary" onclick="convertToInvoice(${est.id})">
                                <i class="fas fa-file-invoice"></i> Convert
                            </button>
                            <button class="btn btn-danger" onclick="deleteEstimate(${est.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function convertToInvoice(estimateId) {
            const estimate = estimates.find(e => e.id === estimateId);
            if (!estimate) return;
            
            const invoice = {
                id: Date.now(),
                customerName: estimate.customerName,
                vehicle: estimate.vehicle,
                date: new Date().toISOString().split('T')[0],
                parts: estimate.parts,
                labor: estimate.labor,
                total: estimate.total,
                status: 'Unpaid'
            };
            
            invoices.push(invoice);
            estimates = estimates.filter(e => e.id !== estimateId);
            saveToStorage();
            renderEstimates();
            renderInvoices();
            alert('Estimate converted to invoice!');
        }

        function deleteEstimate(id) {
            if (confirm('Are you sure you want to delete this estimate?')) {
                estimates = estimates.filter(e => e.id !== id);
                saveToStorage();
                renderEstimates();
            }
        }

        // ============ INVOICE FUNCTIONS ============
        function openInvoiceModal() {
            alert('Invoice creation modal will open here. For now, view sample invoices below.');
        }

        function initSampleInvoices() {
            invoices = [
                {
                    id: 1,
                    customerName: 'Bob Wilson',
                    vehicle: '2019 Ford F-150',
                    date: '2025-01-14',
                    status: 'Paid',
                    parts: [
                        { name: 'Battery', price: 150, quantity: 1 }
                    ],
                    labor: { hours: 0.5, rate: 100 },
                    total: 200
                }
            ];
            saveToStorage();
        }

        function renderInvoices() {
            const list = document.getElementById('invoiceList');
            if (invoices.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">No invoices yet.</p>';
                return;
            }
            
            list.innerHTML = invoices.map(inv => `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="color: #0a2540; margin-bottom: 0.5rem;">${inv.customerName} - ${inv.vehicle}</h3>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-calendar"></i> ${inv.date}</p>
                            <p style="font-weight: bold; color: #0a2540; margin-top: 0.5rem;">Total: $${inv.total.toFixed(2)}</p>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <span class="status-badge status-${inv.status.toLowerCase()}">${inv.status}</span>
                            ${inv.status === 'Unpaid' ? `
                                <button class="btn btn-success" onclick="markAsPaid(${inv.id})">
                                    <i class="fas fa-check"></i> Paid
                                </button>
                            ` : ''}
                            <button class="btn btn-danger" onclick="deleteInvoice(${inv.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function markAsPaid(id) {
            const invoice = invoices.find(i => i.id === id);
            if (invoice) {
                invoice.status = 'Paid';
                invoice.paidDate = new Date().toISOString().split('T')[0];
                saveToStorage();
                renderInvoices();
                alert('Invoice marked as paid!');
            }
        }

        function deleteInvoice(id) {
            if (confirm('Are you sure you want to delete this invoice?')) {
                invoices = invoices.filter(i => i.id !== id);
                saveToStorage();
                renderInvoices();
            }
        }

        // ============ TOWING FUNCTIONS ============
        function initSampleTowing() {
            towingRequests = [
                {
                    id: 1,
                    customerName: 'Mike Johnson',
                    phone: '(555) 555-5555',
                    location: '123 Oak Street, Downtown',
                    vehicle: '2017 Chevrolet Silverado - Black',
                    plate: 'DEF456',
                    destination: 'shop',
                    keyLocation: 'with-customer',
                    meetDriver: 'yes',
                    status: 'Pending',
                    date: new Date().toISOString()
                },
                {
                    id: 2,
                    customerName: 'Sarah Lee',
                    phone: '(555) 666-6666',
                    location: '456 Pine Avenue, Midtown',
                    vehicle: '2019 Nissan Altima - Silver',
                    plate: 'GHI789',
                    destination: 'shop',
                    keyLocation: 'in-vehicle',
                    meetDriver: 'no',
                    status: 'Assigned',
                    date: new Date().toISOString()
                }
            ];
            saveToStorage();
        }

        function saveTowingRequest() {
            const request = {
                id: Date.now(),
                customerName: document.getElementById('towingCustomer').value,
                phone: document.getElementById('towingPhone').value,
                location: document.getElementById('towingLocation').value,
                vehicle: document.getElementById('towingVehicle').value,
                plate: document.getElementById('towingPlate').value,
                destination: document.getElementById('towingDestination').value,
                keyLocation: document.getElementById('keyLocation').value,
                meetDriver: document.getElementById('meetDriver').value,
                status: 'Pending',
                date: new Date().toISOString()
            };
            
            towingRequests.push(request);
            saveToStorage();
            renderTowing();
            closeModal('towingModal');
            alert('Towing request submitted!');
        }

        function renderTowing() {
            const list = document.getElementById('towingList');
            
            // Update stats
            const pending = towingRequests.filter(t => t.status === 'Pending').length;
            const assigned = towingRequests.filter(t => t.status === 'Assigned').length;
            const arrived = towingRequests.filter(t => t.status === 'Arrived').length;
            
            document.getElementById('pendingTowing').textContent = pending;
            document.getElementById('assignedTowing').textContent = assigned;
            document.getElementById('arrivedTowing').textContent = arrived;
            
            if (towingRequests.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">No towing requests yet.</p>';
                return;
            }
            
            list.innerHTML = towingRequests.map(req => `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h3 style="color: #0a2540; margin-bottom: 0.5rem;">${req.customerName}</h3>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-phone"></i> ${req.phone}</p>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-map-marker-alt"></i> ${req.location}</p>
                            <p style="color: #666; margin: 0.25rem 0;"><i class="fas fa-car"></i> ${req.vehicle} (${req.plate})</p>
                            <p style="color: #666; margin: 0.25rem 0;">
                                <i class="fas fa-key"></i> Keys: ${req.keyLocation} | 
                                <i class="fas fa-user"></i> Meet driver: ${req.meetDriver === 'yes' ? 'Yes' : 'No'}
                            </p>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; align-items: end;">
                            <span class="status-badge status-${req.status.toLowerCase()}">${req.status}</span>
                            ${req.status === 'Pending' ? `
                                <button class="btn btn-primary" onclick="assignTowing(${req.id})">
                                    <i class="fas fa-truck"></i> Assign
                                </button>
                            ` : ''}
                            ${req.status === 'Assigned' ? `
                                <button class="btn btn-success" onclick="markArrived(${req.id})">
                                    <i class="fas fa-check-circle"></i> Arrived
                                </button>
                            ` : ''}
                            <button class="btn btn-danger" onclick="deleteTowingRequest(${req.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function assignTowing(id) {
            const request = towingRequests.find(t => t.id === id);
            if (request) {
                request.status = 'Assigned';
                request.assignedAt = new Date().toISOString();
                saveToStorage();
                renderTowing();
                alert('Towing provider assigned!');
            }
        }

        function markArrived(id) {
            const request = towingRequests.find(t => t.id === id);
            if (request) {
                request.status = 'Arrived';
                request.arrivedAt = new Date().toISOString();
                saveToStorage();
                renderTowing();
                alert('Vehicle marked as arrived at the shop!');
            }
        }

        function deleteTowingRequest(id) {
            if (confirm('Are you sure you want to delete this request?')) {
                towingRequests = towingRequests.filter(t => t.id !== id);
                saveToStorage();
                renderTowing();
            }
        }

        // ============ INVENTORY FUNCTIONS ============
        function initSampleInventory() {
            inventory = [
                {
                    id: 1,
                    name: 'Brake Pads (Front)',
                    partNumber: 'BP-F-001',
                    category: 'Brakes',
                    quantity: 15,
                    cost: 25,
                    price: 85,
                    reorderPoint: 5
                },
                {
                    id: 2,
                    name: 'Brake Rotors (Front)',
                    partNumber: 'BR-F-001',
                    category: 'Brakes',
                    quantity: 8,
                    cost: 45,
                    price: 120,
                    reorderPoint: 3
                },
                {
                    id: 3,
                    name: 'Synthetic Oil (5qt)',
                    partNumber: 'OIL-SYN-5',
                    category: 'Fluids',
                    quantity: 20,
                    cost: 18,
                    price: 45,
                    reorderPoint: 5
                },
                {
                    id: 4,
                    name: 'Oil Filter',
                    partNumber: 'FLT-GEN-01',
                    category: 'Filters',
                    quantity: 35,
                    cost: 5,
                    price: 15,
                    reorderPoint: 10
                },
                {
                    id: 5,
                    name: 'Battery (Standard)',
                    partNumber: 'BAT-STD-001',
                    category: 'Electrical',
                    quantity: 4,
                    cost: 75,
                    price: 150,
                    reorderPoint: 2
                },
                {
                    id: 6,
                    name: 'Spark Plugs (Set of 4)',
                    partNumber: 'SPK-SET-4',
                    category: 'Engine',
                    quantity: 12,
                    cost: 12,
                    price: 45,
                    reorderPoint: 4
                }
            ];
            saveToStorage();
        }

        function saveInventoryItem() {
            const item = {
                id: Date.now(),
                name: document.getElementById('inventoryName').value,
                partNumber: document.getElementById('inventoryPartNumber').value,
                category: document.getElementById('inventoryCategory').value,
                quantity: parseInt(document.getElementById('inventoryQuantity').value) || 1,
                cost: parseFloat(document.getElementById('inventoryCost').value) || 0,
                price: parseFloat(document.getElementById('inventoryPrice').value) || 0,
                reorderPoint: parseInt(document.getElementById('inventoryReorderPoint').value) || 2
            };
            
            inventory.push(item);
            saveToStorage();
            renderInventory();
            closeModal('inventoryModal');
            
            // Clear form
            document.getElementById('inventoryName').value = '';
            document.getElementById('inventoryPartNumber').value = '';
            document.getElementById('inventoryQuantity').value = '1';
            document.getElementById('inventoryCost').value = '0';
            document.getElementById('inventoryPrice').value = '0';
            document.getElementById('inventoryReorderPoint').value = '2';
        }

        function renderInventory() {
            const list = document.getElementById('inventoryList');
            
            // Calculate stats
            const totalItems = inventory.reduce((sum, item) => sum + item.quantity, 0);
            const totalValue = inventory.reduce((sum, item) => sum + (item.quantity * item.price), 0);
            const lowStock = inventory.filter(item => item.quantity <= item.reorderPoint).length;
            
            document.getElementById('totalInventoryItems').textContent = totalItems;
            document.getElementById('inventoryValue').textContent = `$${totalValue.toFixed(2)}`;
            document.getElementById('lowStockItems').textContent = lowStock;
            
            if (inventory.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">No inventory items yet. Add your first item!</p>';
                return;
            }
            
            list.innerHTML = inventory.map(item => {
                const value = item.quantity * item.price;
                const profit = value - (item.quantity * item.cost);
                const isLowStock = item.quantity <= item.reorderPoint;
                
                return `
                    <div class="inventory-item" style="${isLowStock ? 'border: 2px solid #f5576c;' : ''}">
                        <div class="inventory-item-name">${item.name}</div>
                        <div class="inventory-item-details">
                            Part #: ${item.partNumber} | Category: ${item.category}
                        </div>
                        <div class="inventory-item-details">
                            Qty: ${item.quantity} | Cost: $${item.cost.toFixed(2)} | Price: $${item.price.toFixed(2)}
                        </div>
                        <div class="inventory-item-value">
                            Total Value: $${value.toFixed(2)} (Profit: $${profit.toFixed(2)})
                        </div>
                        ${isLowStock ? `
                            <div style="color: #f5576c; font-weight: bold; margin-top: 0.5rem;">
                                <i class="fas fa-exclamation-triangle"></i> LOW STOCK - Reorder Now!
                            </div>
                        ` : ''}
                        <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem;">
                            <button class="btn btn-primary" onclick="editInventoryItem(${item.id})" style="font-size: 0.8rem; padding: 0.5rem;">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger" onclick="deleteInventoryItem(${item.id})" style="font-size: 0.8rem; padding: 0.5rem;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function deleteInventoryItem(id) {
            if (confirm('Are you sure you want to delete this item?')) {
                inventory = inventory.filter(i => i.id !== id);
                saveToStorage();
                renderInventory();
            }
        }

        function editInventoryItem(id) {
            alert('Edit functionality coming soon!');
        }
    </script>
</body>
</html>
